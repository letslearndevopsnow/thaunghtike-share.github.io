---
layout:     post
title:   "Backup And Restore Kubernetes Resources Using Velero"
date:       2021-09-09 15:13:18 +0200
image: 6.jpg
tags:
    - Kubernetes
categories: kubernetes
---            

<h2> Introduction </h2>

We have to back up the applications which are deployed on a Kubernetes cluster to protect loss. There are many tools to backup and restore k8s resources like velero and Kasten 10. If you have backups, it is easy to restore if the cluster goes down or an application crashes accidentally. You can also back up k8s resources and persistent volumes on Kubernetes clusters. You can use velero not only to back up and restore but also to migrate clusters. For example, to migrate the PVC used for the database in the on-prem k8s cluster, you have to export database dumps from the old cluster at first then import the dumped databases to the database in the new cluster. Velero can solve these problems. When k8s clusters are migrated, there are limitations to migrating to PVC. The storage class of the PVC which you want to backup must be in the new cluster. Velero does not support host path PVC. You can create snapshots on cloud storage volumes such as EBS and azure disks. If you do not want to create snapshots manually, you can also use velero to back up persistent volumes on managed k8s clusters.

<h2> Installation </h2>

Firstly we have to create a kubernetes cluster. I will use azure aks cluster with two worker nodes for this demo. So, let me create an aks cluster.

```bash
thaunghtikeoo@thaunghtikeoo:~$ az group create --name demo --location eastus && az aks create --name demo -g demo --location eastus --node-count 2 
```
My k8s cluster is ready now. Check the status of cluster's nodes.

```bash
thaunghtikeoo@thaunghtikeoo:~$ kubectl get nodes 
NAME                                STATUS   ROLES   AGE    VERSION
aks-nodepool1-32685854-vmss000000   Ready    agent   112s   v1.20.9
aks-nodepool1-32685854-vmss000001   Ready    agent   2m1s   v1.20.9
```
